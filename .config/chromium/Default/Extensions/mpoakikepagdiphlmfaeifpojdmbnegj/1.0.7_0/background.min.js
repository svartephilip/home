window.chrome&&chrome.app&&chrome.app.runtime&&chrome.app.runtime.onLaunched&&chrome.app.runtime.onLaunched.addListener&&chrome.app.runtime.onLaunched.addListener(function(){a.g()});
var a={YTVD:null,b:null,f:0,a:null,j:{},g:function(){chrome.app.window.create("default.html",{id:"YouTubeVideoDeckPackedApp",frame:"none",bounds:{width:1280,height:720,top:100,left:100},minWidth:580,minHeight:600})},m:function(b){window.clearInterval(a.b);window.clearInterval(a.a);b&&window.setTimeout(a.g,500)},C:function(){a.b&&window.clearInterval(a.b);a.b=window.setInterval(a.A,3E6)},D:function(){a.a&&window.clearInterval(a.a);a.a=window.setInterval(a.YTVD.updateSubs,1E3*a.YTVD.pollingInterval)},
A:function(){a.YTVD.getToken(!0)},createNotification:function(b){window.webkitNotifications&&void 0!==webkitNotifications.createHTMLNotification?(b.videoUrl=a.YTVD.youtubeVideoUrl+b.videoUrl,b=JSON.stringify(b),b="data="+encodeURIComponent(b),b=chrome.extension.getURL("notify.html")+"?"+b,webkitNotifications.createHTMLNotification(b).show(),a.h()):a.YTVD.isPackedApp?a.o(b):a.i(b)},i:function(b){var c;try{if("default"==Notification.permission){Notification.requestPermission(function(){a.i(b)});return}c=
new Notification(b.videoTitle,{body:b.videoDescription,icon:b.videoThumb,tag:"id"+a.f++})}catch(d){a.YTVD.productionize_log("error when creating notification: "+d.message,"thumb:"+b.videoThumb+" title:"+b.videoTitle+" desc:"+b.videoDescription);return}c.data=b;c.onclick=a.s;c.onshow=function(){a.h();setTimeout(function(){c.close()},6E3)}},o:function(b){a.c(b.hqVideoThumb,function(c){a.w(b,c)})},w:function(b,c){b.videoUsernameId||b.videoChId?a.getChannelData(b.videoUsernameId||b.videoChId,b,c):a.c(b.videoUsernameImage||
"https://youtube.videodeck.net/styles/img/custom_column.png",function(d){a.showNotification(b,d,c)})},h:function(){a.YTVD.getSoundNotification()&&(new Audio((a.YTVD.isWebVersion?"deck/":"")+"sound.mp3")).play()},getChannelData:function(b,c,d){a.YTVD.sendSignedRequest("https://gdata.youtube.com/feeds/api/users/"+b,function(b){a.u(b,c,d)},{parameters:{alt:"json",v:"2.1",inline:!0},headers:{"X-GData-Key":"key="+a.YTVD.apiKey[0],Authorization:"Bearer "+a.YTVD.readToken()}})},u:function(b,c,d){var e;try{"string"===
typeof b?e=JSON.parse(b):e=b}catch(f){-1!==b.indexOf("Error 401")&&a.YTVD.getToken(!0);return}a.c((e.entry&&e.entry.media$thumbnail&&e.entry.media$thumbnail.url?e.entry.media$thumbnail.url:"")||"https://youtube.videodeck.net/styles/img/custom_column.png",function(b){a.showNotification(c,b,d)})},showNotification:function(b,c,d){c={type:"image",title:b.videoTitle,message:b.videoDescription,iconUrl:c,imageUrl:d,isClickable:!0};a.j["id"+a.f]=b;chrome.notifications.onClicked.hasListener()||chrome.notifications.onClicked.addListener(a.B);
chrome.notifications.create("id"+a.f++,c,function(){a.h()})},c:function(b,c){var d=new XMLHttpRequest;d.open("GET",b,!0);d.responseType="blob";d.onload=function(b){c(window.URL.createObjectURL(b.target.response))};d.send()},B:function(b){a.l(a.j[b])},s:function(b){a.l(b.target.data)},l:function(b){a.YTVD.videoUrlClicked("http://www.youtube.com/watch?v="+b.videoId+a.YTVD.youtubeFeature,b.videoRestricted)}};
window.chrome&&chrome.browserAction&&chrome.browserAction.onClicked&&chrome.browserAction.onClicked.addListener&&chrome.browserAction.onClicked.addListener(function(){chrome.tabs.create({url:"https://youtube.videodeck.net"})});window.backend=a;a.setIntervals=a.C;a.startPolling=a.D;a.createNotification=a.createNotification;a.openYTVD=a.g;a.closeYTVD=a.m;
