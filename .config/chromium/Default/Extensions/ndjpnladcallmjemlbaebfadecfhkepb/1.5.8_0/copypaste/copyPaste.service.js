!function(){"use strict";angular.module("app.copypaste").factory("copyPasteService",["$log","imageReader",function(r,i){var c;return{handleTestCommand:function(e,t,n){try{n(e.object)}catch(e){r.error(String.format("handleTestCommand() - Exception: {0}",e.toString()))}finally{return r.trackEvent("CopyPaste_Test"),!1}},handleCopyCommand:function(e,t,n){var a;try{(a=document.getElementById("copyPasteSandbox")).innerHTML=e.object,a.focus(),document.execCommand("selectAll"),document.execCommand("copy"),n()}catch(e){r.error(String.format("handleCopyCommand() - Exception: {0}",e.toString()))}finally{return a.innerHTML="",r.trackEvent("CopyPaste_Copy"),!1}},handlePasteCommand:function(e,t,n){var a,o=!1;try{(a=document.getElementById("copyPasteSandbox")).innerHTML="",a.focus(),document.execCommand("selectAll"),document.execCommand("paste")&&(Utilities.isNotUndefinedOrNull(c)&&0<c.length?(i.readImages(c,function(e){n(e)}),o=!0):n(a.innerHTML))}catch(e){r.error(String.format("handlePasteCommand() - Exception: {0}",e.toString()))}finally{return a.innerHTML="",r.trackEvent("CopyPaste_Paste",{IsPrefetchedImage:o}),o}},onPasteEvent:function(e){if(c=[],Utilities.isUndefinedOrNull(e.clipboardData)||Utilities.isUndefinedOrNull(e.clipboardData.items))return;for(var t=e.clipboardData.items,n=0;n<t.length;++n)i.isImageFile(t[n])&&c.push(i.getAsFile(t[n]))}}}])}();