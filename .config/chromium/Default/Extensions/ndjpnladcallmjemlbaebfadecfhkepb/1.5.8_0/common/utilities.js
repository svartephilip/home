var Utilities=function(){"use strict";var t={deserializeQuery:function(e){var n,r=/\+/g,t=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(r," "))},o={};for(n=t.exec(e);n;)o[i(n[1])]=i(n[2]),n=t.exec(e);return o},getFileExtension:function(e){var n="",r=e.split(".");return 1<r.length&&(n=r[r.length-1].toLowerCase()),n},navigateToUrlWithNewTab:function(e,n){BrowserHandler.tabs.create({url:e,active:!!t.isUndefinedOrNull(n)||n})},isNotUndefinedOrNull:function(e){return!t.isUndefinedOrNull(e)},isUndefinedOrNull:function(e){return null==e},isExtensionInTestingMode:function(){return t.isNotUndefinedOrNull(window.jasmine)},isExtensionInDevelopmentMode:function(){if(t.isExtensionInTestingMode())return!1;if(window.browser&&window.browser.extension){var e=BrowserHandler.runtime.getURL("");if(null!=e&&/_microsoftofficeonline_/i.test(e))return!1}else if(window.chrome&&window.chrome.extension){var n=t.getManifest();if(null==n)return!1;if(void 0!==n.key||void 0!==n.update_url)return!1}return!0},getManifest:function(){if("object"!=typeof BrowserHandler.runtime||"function"!=typeof BrowserHandler.runtime.getManifest)return null;var e=BrowserHandler.runtime.getManifest();return null==e?null:e},isBackgroundContext:function(){var e=window.location.href;if(window.browser&&window.browser.extension){if(/^ms-browser-extension/.test(e)&&window===BrowserHandler.extension.getBackgroundPage())return!0}else if(window.chrome&&window.chrome.extension&&/^chrome/.test(e)&&window===BrowserHandler.extension.getBackgroundPage())return!0;return!1},getCurrentTime:function(){return Math.round((new Date).getTime()/1e3)},isChrome:function(){var e=window.navigator,n=-1<e.userAgent.indexOf("OPR"),r=-1<e.userAgent.indexOf("Edge");return t.isNotUndefinedOrNull(window.chrome)&&-1<e.vendor.indexOf("Google")&&!1===n&&!1===r},getBrowserName:function(){return t.isChrome()?"Chrome":"Edge"},isRTL:function(){var e=BrowserHandler.i18n.getUILanguage();return!!(/^ar/i.test(e)||/^fa/i.test(e)||/^he/i.test(e))},setIcon:function(e){BrowserHandler.browserAction.setIcon({path:e})}};return t}();