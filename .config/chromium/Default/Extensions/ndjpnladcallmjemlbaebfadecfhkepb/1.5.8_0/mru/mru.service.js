!function(){"use strict";angular.module("app.mru",[]).factory("mruService",["$q","$log","$http","constants","userService",function(r,e,o,E,t){function i(e,t){var n=r.defer(),i={method:"GET",accept:"application/json",url:t,contentType:"application/json",headers:{"X-UserType":e}};return o(i).success(function(e){n.resolve(e)}).error(function(){n.reject(E.RECENTS.ERROR.GENERIC)}),n.promise}function u(e){var t=[];if(Utilities.isUndefinedOrNull(e))return t;for(var n=0;n<e.length;n++)if(Utilities.isNotUndefinedOrNull(e[n].type)&&Utilities.isNotUndefinedOrNull(e[n].name)){var i;if("notebook"===e[n].type)i="notebook";else if(i=Utilities.getFileExtension(e[n].name),!E.FILE.SUPPORTED_FILE_TYPES[i])continue;t.push({DocumentUrl:e[n].link,Timestamp:e[n].updated_time,Application:E.FILE.SUPPORTED_FILE_TYPES[i],FileName:e[n].name,Id:e[n].id})}return t}return{getRecentDocumentList:function(){var n=r.defer();return t.getUserType().then(function(t){if(t!==E.USER_TYPE.MSA&&t!==E.USER_TYPE.O365)return n.reject(E.RECENTS.ERROR.UNSUPPORTED_USER_TYPE),n.promise;var e=t===E.USER_TYPE.MSA?E.RECENTS.ONEDRIVE_ENDPOINT:E.O365CONFIG.MRU_URL+E.RECENTS.FILTER;i(t,e).then(function(e){n.resolve(t===E.USER_TYPE.MSA?u(e.data):e)},function(e){return n.reject(e),n.promise})}),n.promise},getRecentDocs:i,normalizeMruList:u}}])}();